{
  "nodes":[
    {
      "nodeId":"userGuide",
      "name":"system configuration",
      "intro":"",
      "flowNodeType":"userGuide",
      "position":{
        "x":531.2422736065552,
        "y":-486.7611729549753
      },
      "version":"481",
      "inputs":[

      ],
      "outputs":[

      ]
    },
    {
      "nodeId":"workflowStartNodeId",
      "name":"Process begins",
      "intro":"",
      "avatar":"core/workflow/template/workflowStart",
      "flowNodeType":"workflowStart",
      "position":{
        "x":558.4082376415505,
        "y":123.72387429194112
      },
      "version":"481",
      "inputs":[
        {
          "key":"userChatInput",
          "renderTypeList":[
            "reference",
            "textarea"
          ],
          "valueType":"string",
          "label":"workflow:user_question",
          "toolDescription":"workflow:user_question",
          "required":true
        }
      ],
      "outputs":[
        {
          "id":"userChatInput",
          "key":"userChatInput",
          "label":"common:core.module.input.label.user question",
          "type":"static",
          "valueType":"string"
        },
        {
          "id":"userFiles",
          "key":"userFiles",
          "label":"app:workflow.user_file_input",
          "description":"app:workflow.user_file_input_desc",
          "type":"static",
          "valueType":"arrayString"
        }
      ]
    },
    {
      "nodeId":"7BdojPlukIQw",
      "name":"AI dialogue",
      "intro":"AI Large Model Dialogue",
      "avatar":"core/workflow/template/aiChat",
      "flowNodeType":"chatNode",
      "showStatus":true,
      "position":{
        "x":1106.3238387960757,
        "y":-350.6030674683474
      },
      "version":"481",
      "inputs":[
        {
          "key":"model",
          "renderTypeList":[
            "settingLLMModel",
            "reference"
          ],
          "label":"",
          "valueType":"string",
          "value":"llama3:latest"
        },
        {
          "key":"temperature",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "value":3,
          "valueType":"number",
          "min":0,
          "max":10,
          "step":1
        },
        {
          "key":"maxToken",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "value":1950,
          "valueType":"number",
          "min":100,
          "max":4000,
          "step":50
        },
        {
          "key":"isResponseAnswerText",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "value":true,
          "valueType":"boolean"
        },
        {
          "key":"aiChatQuoteRole",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"string",
          "value":"system"
        },
        {
          "key":"quoteTemplate",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"string"
        },
        {
          "key":"quotePrompt",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"string"
        },
        {
          "key":"systemPrompt",
          "renderTypeList":[
            "textarea",
            "reference"
          ],
          "max":3000,
          "valueType":"string",
          "label":"core.ai.Prompt",
          "description":"core.app.tip.systemPromptTip",
          "placeholder":"core.app.tip.chatNodeSystemPromptTip",
          "value":"gfhgfh"
        },
        {
          "key":"history",
          "renderTypeList":[
            "numberInput",
            "reference"
          ],
          "valueType":"chatHistory",
          "label":"core.module.input.label.chat history",
          "required":true,
          "min":0,
          "max":30,
          "value":6
        },
        {
          "key":"userChatInput",
          "renderTypeList":[
            "reference",
            "textarea"
          ],
          "valueType":"string",
          "label":"common:core.module.input.label.user question",
          "required":true,
          "toolDescription":"common:core.module.input.label.user question",
          "value":[
            "workflowStartNodeId",
            "userChatInput"
          ]
        },
        {
          "key":"quoteQA",
          "renderTypeList":[
            "settingDatasetQuotePrompt"
          ],
          "label":"",
          "debugLabel":"common:core.module.Dataset quote.label",
          "description":"",
          "valueType":"datasetQuote",
          "value":[
            "iKBoX2vIzETU",
            "quoteQA"
          ]
        },
        {
          "key":"aiChatVision",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"boolean",
          "value":true
        }
      ],
      "outputs":[
        {
          "id":"history",
          "key":"history",
          "required":true,
          "label":"common:core.module.output.label.New context",
          "description":"common:core.module.output.description.New context",
          "valueType":"chatHistory",
          "valueDesc":"{ obj: System | Human | AI; value: string; }[]",
          "type":"static"
        },
        {
          "id":"answerText",
          "key":"answerText",
          "required":true,
          "label":"common:core.module.output.label.Ai response content",
          "description":"common:core.module.output.description.Ai response content",
          "valueType":"string",
          "type":"static"
        }
      ]
    },
    {
      "nodeId":"iKBoX2vIzETU",
      "name":"Knowledge Base Search",
      "intro":"Call the 'semantic retrieval' and 'full-text retrieval' capabilities to search for reference content that may be relevant to the problem from the 'knowledge base'",
      "avatar":"core/workflow/template/datasetSearch",
      "flowNodeType":"datasetSearchNode",
      "showStatus":true,
      "position":{
        "x":918.5901682164496,
        "y":-227.11542247619582
      },
      "version":"481",
      "inputs":[
        {
          "key":"datasets",
          "renderTypeList":[
            "selectDataset",
            "reference"
          ],
          "label":"core.module.input.label.Select dataset",
          "value":[
            {
              "datasetId":"6746e7eeea059f95ac6179df"
            }
          ],
          "valueType":"selectDataset",
          "list":[

          ],
          "required":true
        },
        {
          "key":"similarity",
          "renderTypeList":[
            "selectDatasetParamsModal"
          ],
          "label":"",
          "value":0.4,
          "valueType":"number"
        },
        {
          "key":"limit",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "value":1500,
          "valueType":"number"
        },
        {
          "key":"searchMode",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"string",
          "value":"embedding"
        },
        {
          "key":"usingReRank",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"boolean",
          "value":false
        },
        {
          "key":"datasetSearchUsingExtensionQuery",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"boolean",
          "value":true
        },
        {
          "key":"datasetSearchExtensionModel",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"string"
        },
        {
          "key":"datasetSearchExtensionBg",
          "renderTypeList":[
            "hidden"
          ],
          "label":"",
          "valueType":"string",
          "value":""
        },
        {
          "key":"userChatInput",
          "renderTypeList":[
            "reference",
            "textarea"
          ],
          "valueType":"string",
          "label":"workflow:user_question",
          "toolDescription":"workflow:content_to_search",
          "required":true,
          "value":[
            "workflowStartNodeId",
            "userChatInput"
          ]
        }
      ],
      "outputs":[
        {
          "id":"quoteQA",
          "key":"quoteQA",
          "label":"common:core.module.Dataset quote.label",
          "description":"workflow:special_array_format",
          "type":"static",
          "valueType":"datasetQuote",
          "valueDesc":"{ id: string; datasetId: string; collectionId: string; sourceName: string; sourceId?: string; q: string; a: string }[]"
        }
      ]
    }
  ],
  "edges":[
    {
      "source":"workflowStartNodeId",
      "target":"iKBoX2vIzETU",
      "sourceHandle":"workflowStartNodeId-source-right",
      "targetHandle":"iKBoX2vIzETU-target-left"
    },
    {
      "source":"iKBoX2vIzETU",
      "target":"7BdojPlukIQw",
      "sourceHandle":"iKBoX2vIzETU-source-right",
      "targetHandle":"7BdojPlukIQw-target-left"
    }
  ],
  "chatConfig":{
    "questionGuide":false,
    "ttsConfig":{
      "type":"web"
    },
    "whisperConfig":{
      "open":false,
      "autoSend":false,
      "autoTTSResponse":false
    },
    "scheduledTriggerConfig":{
      "cronString":"",
      "timezone":"Asia/Shanghai",
      "defaultPrompt":""
    },
    "chatInputGuide":{
      "open":false,
      "textList":[

      ],
      "customUrl":""
    },
    "instruction":"",
    "variables":[

    ],
    "welcomeText":"Hello, I am Knowledge Base Assistant. Please don't forget to select the knowledge base. [Who are you] [How to use]"
  },
  "type":"simple",
  "isPublish":true,
  "versionName":"2024-12-03 09:39:01"
}